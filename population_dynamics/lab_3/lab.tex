% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={FAS6337C - Lab 3},
  pdfauthor={Marcel Gietzmann-Sanders},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{FAS6337C - Lab 3}
\author{Marcel Gietzmann-Sanders}
\date{}

\begin{document}
\maketitle

\hypertarget{growth-models-in-r}{%
\section{Growth Models in R}\label{growth-models-in-r}}

Data for this laboratory are from two Florida Spotted Seatrout Cynoscion
nebulosus populations (Indian River and Charlotte Harbor). The data set
contains only females from each population. Fish were collected from
1986 to 1988 by Murphy and Taylor (1994, Transactions of the American
Fisheries Society 123:482-497).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{setwd}\NormalTok{(}\StringTok{"/workspaces/schooling/population\_dynamics/lab\_3/"}\NormalTok{)}
\NormalTok{trout\_data \textless{}{-}}\StringTok{ }\KeywordTok{read.table}\NormalTok{(}\StringTok{"data/trout.txt"}\NormalTok{, }\DataTypeTok{header=}\NormalTok{T, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{) }
\KeywordTok{head}\NormalTok{(trout\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##               bay  tl   sex annuli age yearsold
## 1 CharlotteHarbor 387 FALSE      1   1    1.652
## 2 CharlotteHarbor 355 FALSE      1   1    1.652
## 3 CharlotteHarbor 355 FALSE      1   1    1.652
## 4 CharlotteHarbor 320 FALSE      1   1    1.652
## 5 CharlotteHarbor 335 FALSE      1   1    1.652
## 6 CharlotteHarbor 410 FALSE      1   1    1.652
\end{verbatim}

The objectives of this laboratory are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  To determine the best growth model for each population and estimate
  L\_âˆž, t\_0, and k;
\item
  Estimate the mean length at age for each population;
\item
  Use an AIC model selection method to compare growth curves and
  parameters between populations.
\end{enumerate}

Please conduct the following analyses in R and answer the questions.
Each question or bullet point should be responded to either with text, a
table, or a plot. Use trout.txt as your data file.

\hypertarget{use-nonlinear-least-squares-nls-to-estimate-the-von-bertalanffy-growth-parameters-separately-for-charlotte-harbor-and-for-indian-river-populations.}{%
\subsection{1. Use nonlinear least squares (nls) to estimate the von
Bertalanffy growth parameters separately for Charlotte Harbor and for
Indian River
populations.}\label{use-nonlinear-least-squares-nls-to-estimate-the-von-bertalanffy-growth-parameters-separately-for-charlotte-harbor-and-for-indian-river-populations.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ch\_data \textless{}{-}}\StringTok{ }\KeywordTok{na.omit}\NormalTok{(}
\NormalTok{    trout\_data[trout\_data}\OperatorTok{$}\NormalTok{bay }\OperatorTok{==}\StringTok{ \textquotesingle{}CharlotteHarbor\textquotesingle{}}\NormalTok{,]}
\NormalTok{)}
\NormalTok{ch\_data \textless{}{-}}\StringTok{ }\NormalTok{ch\_data[}\KeywordTok{order}\NormalTok{(ch\_data}\OperatorTok{$}\NormalTok{yearsold),]}
\NormalTok{ir\_data \textless{}{-}}\StringTok{ }\KeywordTok{na.omit}\NormalTok{(}
\NormalTok{    trout\_data[trout\_data}\OperatorTok{$}\NormalTok{bay }\OperatorTok{==}\StringTok{ \textquotesingle{}IndianRiver\textquotesingle{}}\NormalTok{,]}
\NormalTok{)}
\NormalTok{ir\_data \textless{}{-}}\StringTok{ }\NormalTok{ir\_data[}\KeywordTok{order}\NormalTok{(ir\_data}\OperatorTok{$}\NormalTok{yearsold),]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{do\_least\_squares\_fit \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(fish\_data, Linf, vbk, tknot) \{}
\NormalTok{  tl \textless{}{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(fish\_data}\OperatorTok{$}\NormalTok{tl)}
\NormalTok{  yearsold \textless{}{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(fish\_data}\OperatorTok{$}\NormalTok{yearsold)}
\NormalTok{  result \textless{}{-}}\StringTok{ }\KeywordTok{nls}\NormalTok{(}
\NormalTok{    tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{Linf }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(}\OperatorTok{{-}}\NormalTok{vbk }\OperatorTok{*}\StringTok{ }\NormalTok{(yearsold }\OperatorTok{{-}}\StringTok{ }\NormalTok{tknot))),}
    \DataTypeTok{data=}\NormalTok{fish\_data,}
    \DataTypeTok{start=}\KeywordTok{list}\NormalTok{(}\DataTypeTok{Linf=}\NormalTok{Linf, }\DataTypeTok{vbk=}\NormalTok{vbk, }\DataTypeTok{tknot=}\NormalTok{tknot)}
\NormalTok{  )}
  \KeywordTok{return}\NormalTok{(result)}
\NormalTok{\}}

\NormalTok{ch\_result =}\StringTok{ }\KeywordTok{do\_least\_squares\_fit}\NormalTok{(ch\_data, }\DecValTok{800}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.4}\NormalTok{)}
\NormalTok{ir\_result =}\StringTok{ }\KeywordTok{do\_least\_squares\_fit}\NormalTok{(ir\_data, }\DecValTok{950}\NormalTok{, }\FloatTok{0.19}\NormalTok{, }\FloatTok{{-}1.2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(ch\_result)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Formula: tl ~ Linf * (1 - exp(-vbk * (yearsold - tknot)))
## 
## Parameters:
##        Estimate Std. Error t value Pr(>|t|)    
## Linf  788.88587   44.03635  17.914  < 2e-16 ***
## vbk     0.20546    0.02685   7.651 4.34e-14 ***
## tknot  -1.45233    0.17197  -8.445  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 42.07 on 1099 degrees of freedom
## 
## Number of iterations to convergence: 4 
## Achieved convergence tolerance: 2.277e-06
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(ir\_result)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Formula: tl ~ Linf * (1 - exp(-vbk * (yearsold - tknot)))
## 
## Parameters:
##       Estimate Std. Error t value Pr(>|t|)    
## Linf  977.2375    63.8731  15.300  < 2e-16 ***
## vbk     0.1894     0.0261   7.259 7.03e-13 ***
## tknot  -1.2178     0.1550  -7.857 8.77e-15 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 58.34 on 1192 degrees of freedom
## 
## Number of iterations to convergence: 2 
## Achieved convergence tolerance: 5.089e-06
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{nls\_tl \textless{}{-}}\StringTok{ }\NormalTok{ch\_result}\OperatorTok{$}\NormalTok{m}\OperatorTok{$}\KeywordTok{predict}\NormalTok{(ch\_data}\OperatorTok{$}\NormalTok{yearsold)}
\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{nls\_tl \textless{}{-}}\StringTok{ }\NormalTok{ir\_result}\OperatorTok{$}\NormalTok{m}\OperatorTok{$}\KeywordTok{predict}\NormalTok{(ir\_data}\OperatorTok{$}\NormalTok{yearsold)}

\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{nls\_res \textless{}{-}}\StringTok{ }\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{tl }\OperatorTok{{-}}\StringTok{ }\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{nls\_tl}
\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{nls\_res \textless{}{-}}\StringTok{ }\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{tl }\OperatorTok{{-}}\StringTok{ }\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{nls\_tl}

\KeywordTok{head}\NormalTok{(ch\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                  bay  tl   sex annuli age yearsold   nls_tl  nls_res
## 2150 CharlotteHarbor 302 FALSE      0   0    0.487 259.2628 42.73723
## 2160 CharlotteHarbor 294 FALSE      0   0    0.487 259.2628 34.73723
## 1165 CharlotteHarbor 329 FALSE      1   0    0.589 270.2466 58.75343
## 1188 CharlotteHarbor 303 FALSE      0   0    0.589 270.2466 32.75343
## 1189 CharlotteHarbor 286 FALSE      0   0    0.589 270.2466 15.75343
## 1190 CharlotteHarbor 296 FALSE      0   0    0.589 270.2466 25.75343
\end{verbatim}

\hypertarget{plot-the-residuals-against-the-predicted-values-from-the-nls-for-each-population.}{%
\subsubsection{Plot the residuals against the predicted values from the
nls for each
population.}\label{plot-the-residuals-against-the-predicted-values-from-the-nls-for-each-population.}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ch\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      nls\_res }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{nls\_tl,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Charlotte Harbor Residuals Plot\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Predicted Length (mm)\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Actual {-} Predicted Length (mm)\textquotesingle{}}
\NormalTok{    )}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ir\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      nls\_res }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{nls\_tl,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Indian River Residuals Plot\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Predicted Length (mm)\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Actual {-} Predicted Length (mm)\textquotesingle{}}
\NormalTok{    )}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ch\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Charlotte Harbor Fit\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Years Old\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Length (mm)\textquotesingle{}}
\NormalTok{    )}
    \KeywordTok{lines}\NormalTok{(nls\_tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold, }\DataTypeTok{col=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ir\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Indian River Fit\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Years Old\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Length (mm)\textquotesingle{}}
\NormalTok{    )}
    \KeywordTok{lines}\NormalTok{(nls\_tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold, }\DataTypeTok{col=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-10-1.pdf}

\hypertarget{does-it-appear-that-a-von-bertalanffy-curve-is-reasonable-for-each-population}{%
\subsubsection{Does it appear that a von Bertalanffy curve is reasonable
for each
population?}\label{does-it-appear-that-a-von-bertalanffy-curve-is-reasonable-for-each-population}}

The conclusion here is the same as in the last lab. The fit is
reasonable but far from ideal. There is a clear pattern from under
predicting to overpredicting as length increases so there's definitely a
pattern to the residuals that (in theory) could be captured in a better
model.

There's also quite a lot of variance left in these estimates, and that
variance itself is patterned.

\hypertarget{for-the-charlotte-harbor-population-create-a-function-that-estimates-the-negative-log-likelihood-of-the-normal-distribution.-minimize-the-negative-log-likelihood-of-the-normal-distribution-to-estimate-the-parameters-of-the-von-bertalanffy-growth-equation.}{%
\subsection{2. For the Charlotte Harbor population, create a function
that estimates the negative log likelihood of the normal distribution.
Minimize the negative log likelihood of the normal distribution to
estimate the parameters of the von Bertalanffy growth
equation.}\label{for-the-charlotte-harbor-population-create-a-function-that-estimates-the-negative-log-likelihood-of-the-normal-distribution.-minimize-the-negative-log-likelihood-of-the-normal-distribution-to-estimate-the-parameters-of-the-von-bertalanffy-growth-equation.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predict\_length \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(yearsold, Linf, vbk, tknot) \{}
\NormalTok{  pred\_tl \textless{}{-}}\StringTok{ }\NormalTok{Linf }\OperatorTok{*}\StringTok{ }\NormalTok{(}\DecValTok{1} \OperatorTok{{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(}\OperatorTok{{-}}\NormalTok{vbk }\OperatorTok{*}\StringTok{ }\NormalTok{(yearsold }\OperatorTok{{-}}\StringTok{ }\NormalTok{tknot)))}
  \KeywordTok{return}\NormalTok{(pred\_tl)}
\NormalTok{\}}

\NormalTok{get\_likelihood \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(yearsold, tl, Linf, vbk, tknot, sig) \{}
\NormalTok{  pred\_tl \textless{}{-}}\StringTok{ }\KeywordTok{predict\_length}\NormalTok{(yearsold, Linf, vbk, tknot)}
\NormalTok{  NLL \textless{}{-}}\StringTok{ }\DecValTok{{-}1} \OperatorTok{*}\StringTok{ }\KeywordTok{sum}\NormalTok{(}\KeywordTok{dnorm}\NormalTok{(tl, pred\_tl, sig, }\DataTypeTok{log=}\NormalTok{T), }\DataTypeTok{na.rm=}\NormalTok{T)}
  \KeywordTok{return}\NormalTok{(NLL)}
\NormalTok{\}}

\NormalTok{do\_likelihood\_fit \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(fish\_data, Linf, vbk, tknot, sig) \{}
\NormalTok{  tl \textless{}{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(fish\_data}\OperatorTok{$}\NormalTok{tl)}
\NormalTok{  yearsold \textless{}{-}}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(fish\_data}\OperatorTok{$}\NormalTok{yearsold)}
\NormalTok{  lLinf \textless{}{-}}\StringTok{ }\KeywordTok{log}\NormalTok{(Linf)}
\NormalTok{  lsig \textless{}{-}}\StringTok{ }\KeywordTok{log}\NormalTok{(sig)}

\NormalTok{  objective \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(v) \{}
\NormalTok{    Linf \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(v[}\DecValTok{1}\NormalTok{])}
\NormalTok{    vbk \textless{}{-}}\StringTok{ }\NormalTok{v[}\DecValTok{2}\NormalTok{]}
\NormalTok{    tknot \textless{}{-}}\StringTok{ }\NormalTok{v[}\DecValTok{3}\NormalTok{]}
\NormalTok{    sig \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(v[}\DecValTok{4}\NormalTok{])}
\NormalTok{    NLL \textless{}{-}}\StringTok{ }\KeywordTok{get\_likelihood}\NormalTok{(yearsold, tl, Linf, vbk, tknot, sig)}
    \KeywordTok{return}\NormalTok{(NLL)}
\NormalTok{  \}}

\NormalTok{  v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(lLinf, vbk, tknot, lsig)}
\NormalTok{  fit \textless{}{-}}\StringTok{ }\KeywordTok{optim}\NormalTok{(v, objective, }\DataTypeTok{hessian=}\NormalTok{T)}
  \KeywordTok{print}\NormalTok{(}\StringTok{"Fit Summary"}\NormalTok{)}
  \KeywordTok{print}\NormalTok{(fit)}


\NormalTok{  covm \textless{}{-}}\StringTok{ }\KeywordTok{solve}\NormalTok{(fit}\OperatorTok{$}\NormalTok{hessian)}

\NormalTok{  pred \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
    \KeywordTok{exp}\NormalTok{(fit}\OperatorTok{$}\NormalTok{par[}\DecValTok{1}\NormalTok{]),}
\NormalTok{    fit}\OperatorTok{$}\NormalTok{par[}\DecValTok{2}\NormalTok{],}
\NormalTok{    fit}\OperatorTok{$}\NormalTok{par[}\DecValTok{3}\NormalTok{],}
    \KeywordTok{exp}\NormalTok{(fit}\OperatorTok{$}\NormalTok{par[}\DecValTok{4}\NormalTok{])}
\NormalTok{  )}
  \KeywordTok{print}\NormalTok{(pred)}
  \KeywordTok{return}\NormalTok{(}\KeywordTok{list}\NormalTok{(pred, covm, fit}\OperatorTok{$}\NormalTok{par))}
\NormalTok{\}}

\NormalTok{ch\_ml\_result \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(ch\_data, }\DecValTok{800}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.4}\NormalTok{, }\DecValTok{40}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Fit Summary"
## $par
## [1]  6.6703456  0.2055542 -1.4520493  3.7381685
## 
## $value
## [1] 5683.029
## 
## $counts
## function gradient 
##      157       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]          [,3]        [,4]
## [1,] 112145.777336  348609.06203 -19240.314501    7.352657
## [2,] 348609.062030 1102530.32351 -62593.953455   25.512458
## [3,] -19240.314501  -62593.95346   3753.243085   -1.014529
## [4,]      7.352657      25.51246     -1.014529 2203.590885
## 
## [1] 788.6681316   0.2055542  -1.4520493  42.0209562
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ch\_pred\_params \textless{}{-}}\StringTok{ }\NormalTok{ch\_ml\_result[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{ch\_covm \textless{}{-}}\StringTok{ }\NormalTok{ch\_ml\_result[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{ch\_ml\_par \textless{}{-}}\StringTok{ }\NormalTok{ch\_ml\_result[[}\DecValTok{3}\NormalTok{]]}

\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{ml\_tl \textless{}{-}}\StringTok{ }\KeywordTok{predict\_length}\NormalTok{(}
\NormalTok{  ch\_data}\OperatorTok{$}\NormalTok{yearsold, ch\_pred\_params[}\DecValTok{1}\NormalTok{], ch\_pred\_params[}\DecValTok{2}\NormalTok{], ch\_pred\_params[}\DecValTok{3}\NormalTok{]}
\NormalTok{)}
\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{ml\_res \textless{}{-}}\StringTok{ }\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{tl }\OperatorTok{{-}}\StringTok{ }\NormalTok{ch\_data}\OperatorTok{$}\NormalTok{ml\_tl}
\end{Highlighting}
\end{Shaded}

\hypertarget{plot-the-residuals-against-the-predicted-values-from-the-likelihood-estimation}{%
\subsubsection{Plot the residuals against the predicted values from the
likelihood
estimation}\label{plot-the-residuals-against-the-predicted-values-from-the-likelihood-estimation}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ch\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      ml\_res }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{ml\_tl,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Charlotte Harbor Residuals Plot\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Predicted Length (mm)\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Actual {-} Predicted Length (mm)\textquotesingle{}}
\NormalTok{    )}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ch\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Charlotte Harbor Fit\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Years Old\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Length (mm)\textquotesingle{}}
\NormalTok{    )}
    \KeywordTok{lines}\NormalTok{(ml\_tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold, }\DataTypeTok{col=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-13-1.pdf}

\hypertarget{does-the-likelihood-estimation-appear-to-return-vbgm-parameter-estimates-that-are-a-reasonable-model-for-the-data}{%
\subsubsection{Does the likelihood estimation appear to return VBGM
parameter estimates that are a reasonable model for the
data?}\label{does-the-likelihood-estimation-appear-to-return-vbgm-parameter-estimates-that-are-a-reasonable-model-for-the-data}}

\(t_0\) is clearly off and the model seems to be overpredicting
\(L_{\infty}\). Furthermore there is clearly changing variance with both
age and length so the \(\sigma\) parameter is also contentious. Overall
the fit to the data given is reasonable.

\hypertarget{compare-your-estimates-to-the-between-the-nls-question-1-and-the-likelihood-estimation.}{%
\subsubsection{Compare your estimates to the between the nls (question
1) and the likelihood
estimation.}\label{compare-your-estimates-to-the-between-the-nls-question-1-and-the-likelihood-estimation.}}

Besides having added \(\sigma\) this is the same fit. So the estimates
are the same.

\hypertarget{generate-the-confidence-intervals-for-each-parameter-from-the-model-using-the-output-from-nls-and-the-hessian-matrix-from-optim.}{%
\subsection{3. Generate the confidence intervals for each parameter from
the model using the output from nls and the Hessian matrix from
Optim.}\label{generate-the-confidence-intervals-for-each-parameter-from-the-model-using-the-output-from-nls-and-the-hessian-matrix-from-optim.}}

\hypertarget{report-the-confidence-intervals-for-each-parameter-from-each-method-in-a-table}{%
\subsubsection{Report the confidence intervals for each parameter from
each method in a
table}\label{report-the-confidence-intervals-for-each-parameter-from-each-method-in-a-table}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ml\_stderr \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(ch\_covm))}

\NormalTok{ALPHA \textless{}{-}}\StringTok{ }\FloatTok{0.05}
\NormalTok{ML\_L95 \textless{}{-}}\StringTok{ }\NormalTok{(ch\_ml\_par }\OperatorTok{{-}}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ml\_stderr)}
\NormalTok{ML\_U95 \textless{}{-}}\StringTok{ }\NormalTok{(ch\_ml\_par }\OperatorTok{+}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ml\_stderr)}
\NormalTok{ML\_U95[}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_U95[}\DecValTok{1}\NormalTok{])}
\NormalTok{ML\_L95[}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_L95[}\DecValTok{1}\NormalTok{])}
\NormalTok{ML\_U95[}\DecValTok{4}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_U95[}\DecValTok{4}\NormalTok{])}
\NormalTok{ML\_L95[}\DecValTok{4}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_L95[}\DecValTok{4}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ch\_nls\_par \textless{}{-}}\StringTok{ }\KeywordTok{summary}\NormalTok{(ch\_result)}\OperatorTok{$}\NormalTok{parameters[,}\DecValTok{1}\NormalTok{]}
\NormalTok{ch\_nls\_stderr \textless{}{-}}\StringTok{ }\KeywordTok{summary}\NormalTok{(ch\_result)}\OperatorTok{$}\NormalTok{parameters[,}\DecValTok{2}\NormalTok{]}
\NormalTok{NLS\_L95 \textless{}{-}}\StringTok{ }\NormalTok{(ch\_nls\_par }\OperatorTok{{-}}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ch\_nls\_stderr)}
\NormalTok{NLS\_U95 \textless{}{-}}\StringTok{ }\NormalTok{(ch\_nls\_par }\OperatorTok{+}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ch\_nls\_stderr)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NLS\_U95[}\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{] \textless{}{-}}\StringTok{ }\OtherTok{NaN}
\NormalTok{NLS\_L95[}\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{] \textless{}{-}}\StringTok{ }\OtherTok{NaN}
\KeywordTok{rbind}\NormalTok{(ML\_U95, ML\_L95, NLS\_U95, NLS\_L95)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Linf       vbk     tknot      sig
## ML_U95  870.2427 0.2528076 -1.146851 43.81258
## ML_L95  714.7402 0.1583008 -1.757248 40.30259
## NLS_U95 875.1955 0.2580933 -1.115282      NaN
## NLS_L95 702.5762 0.1528279 -1.789379      NaN
\end{verbatim}

\hypertarget{compare-the-estimated-confidence-intervals-between-methods.}{%
\subsubsection{Compare the estimated confidence intervals between
methods.}\label{compare-the-estimated-confidence-intervals-between-methods.}}

\(\sigma\) obviously offers no comparison as it is not in both methods.
\(t_0\) and \(k\) are both very similar between the two methods.
\(L_{\infty}\) is the only one that stands out but it was fit as the log
of itself during maximum likelihood estimation and so it's expected that
the confidence interval for \(L_{\infty}\) is asymmetric.

\hypertarget{conduct-the-same-analysis-for-the-indian-river-population-questions-1-3.-answer-the-same-questionsbullet-points.}{%
\subsection{4. Conduct the same analysis for the Indian River population
(questions 1-3). Answer the same questions/bullet
points.}\label{conduct-the-same-analysis-for-the-indian-river-population-questions-1-3.-answer-the-same-questionsbullet-points.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ir\_ml\_result \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(ir\_data, }\DecValTok{950}\NormalTok{, }\FloatTok{0.19}\NormalTok{, }\FloatTok{{-}1.2}\NormalTok{, }\DecValTok{40}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Fit Summary"
## $par
## [1]  6.8842492  0.1896156 -1.2168596  4.0649088
## 
## $value
## [1] 6553.262
## 
## $counts
## function gradient 
##      177       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]          [,3]        [,4]
## [1,]  76708.491347  276090.71644 -15324.743368    2.288774
## [2,] 276090.716445 1009606.09770 -57676.210383   11.120881
## [3,] -15324.743368  -57676.21038   3507.467652   -0.400318
## [4,]      2.288774      11.12088     -0.400318 2390.262904
## 
## [1] 976.7680293   0.1896156  -1.2168596  58.2595954
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ir\_pred\_params \textless{}{-}}\StringTok{ }\NormalTok{ir\_ml\_result[[}\DecValTok{1}\NormalTok{]]}
\NormalTok{ir\_covm \textless{}{-}}\StringTok{ }\NormalTok{ir\_ml\_result[[}\DecValTok{2}\NormalTok{]]}
\NormalTok{ir\_ml\_par \textless{}{-}}\StringTok{ }\NormalTok{ir\_ml\_result[[}\DecValTok{3}\NormalTok{]]}

\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{ml\_tl \textless{}{-}}\StringTok{ }\KeywordTok{predict\_length}\NormalTok{(}
\NormalTok{  ir\_data}\OperatorTok{$}\NormalTok{yearsold, ir\_pred\_params[}\DecValTok{1}\NormalTok{], ir\_pred\_params[}\DecValTok{2}\NormalTok{], ir\_pred\_params[}\DecValTok{3}\NormalTok{]}
\NormalTok{)}
\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{ml\_res \textless{}{-}}\StringTok{ }\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{tl }\OperatorTok{{-}}\StringTok{ }\NormalTok{ir\_data}\OperatorTok{$}\NormalTok{ml\_tl}
\end{Highlighting}
\end{Shaded}

\hypertarget{plot-the-residuals-against-the-predicted-values-from-the-likelihood-estimation-1}{%
\subsubsection{Plot the residuals against the predicted values from the
likelihood
estimation}\label{plot-the-residuals-against-the-predicted-values-from-the-likelihood-estimation-1}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ir\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      ml\_res }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{ml\_tl,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Indian River Residuals Plot\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Predicted Length (mm)\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Actual {-} Predicted Length (mm)\textquotesingle{}}
\NormalTok{    )}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-18-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{with}\NormalTok{(}
\NormalTok{  ir\_data, \{}
    \KeywordTok{plot}\NormalTok{(}
\NormalTok{      tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold,}
      \DataTypeTok{main=}\StringTok{\textquotesingle{}Indian River Fit\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{xlab=}\StringTok{\textquotesingle{}Years Old\textquotesingle{}}\NormalTok{,}
      \DataTypeTok{ylab=}\StringTok{\textquotesingle{}Length (mm)\textquotesingle{}}
\NormalTok{    )}
    \KeywordTok{lines}\NormalTok{(ml\_tl }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{yearsold, }\DataTypeTok{col=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{lab_files/figure-latex/unnamed-chunk-19-1.pdf}

\hypertarget{does-the-likelihood-estimation-appear-to-return-vbgm-parameter-estimates-that-are-a-reasonable-model-for-the-data-1}{%
\subsubsection{Does the likelihood estimation appear to return VBGM
parameter estimates that are a reasonable model for the
data?}\label{does-the-likelihood-estimation-appear-to-return-vbgm-parameter-estimates-that-are-a-reasonable-model-for-the-data-1}}

\(t_0\) is clearly off again. There is still clearly changing variance
with both age and length so the \(\sigma\) parameter is also
contentious. Overall the fit to the data given is reasonable.

\hypertarget{compare-your-estimates-to-the-between-the-nls-question-1-and-the-likelihood-estimation.-1}{%
\subsubsection{Compare your estimates to the between the nls (question
1) and the likelihood
estimation.}\label{compare-your-estimates-to-the-between-the-nls-question-1-and-the-likelihood-estimation.-1}}

Besides having added \(\sigma\) this is the same fit. So the estimates
are the same.

\hypertarget{report-the-confidence-intervals-for-each-parameter-from-each-method-in-a-table-1}{%
\subsubsection{Report the confidence intervals for each parameter from
each method in a
table}\label{report-the-confidence-intervals-for-each-parameter-from-each-method-in-a-table-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ml\_stderr \textless{}{-}}\StringTok{ }\KeywordTok{sqrt}\NormalTok{(}\KeywordTok{diag}\NormalTok{(ir\_covm))}

\NormalTok{ALPHA \textless{}{-}}\StringTok{ }\FloatTok{0.05}
\NormalTok{ML\_L95 \textless{}{-}}\StringTok{ }\NormalTok{(ir\_ml\_par }\OperatorTok{{-}}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ml\_stderr)}
\NormalTok{ML\_U95 \textless{}{-}}\StringTok{ }\NormalTok{(ir\_ml\_par }\OperatorTok{+}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ml\_stderr)}
\NormalTok{ML\_U95[}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_U95[}\DecValTok{1}\NormalTok{])}
\NormalTok{ML\_L95[}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_L95[}\DecValTok{1}\NormalTok{])}
\NormalTok{ML\_U95[}\DecValTok{4}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_U95[}\DecValTok{4}\NormalTok{])}
\NormalTok{ML\_L95[}\DecValTok{4}\NormalTok{] \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(ML\_L95[}\DecValTok{4}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ir\_nls\_par \textless{}{-}}\StringTok{ }\KeywordTok{summary}\NormalTok{(ir\_result)}\OperatorTok{$}\NormalTok{parameters[,}\DecValTok{1}\NormalTok{]}
\NormalTok{ir\_nls\_stderr \textless{}{-}}\StringTok{ }\KeywordTok{summary}\NormalTok{(ir\_result)}\OperatorTok{$}\NormalTok{parameters[,}\DecValTok{2}\NormalTok{]}
\NormalTok{NLS\_L95 \textless{}{-}}\StringTok{ }\NormalTok{(ir\_nls\_par }\OperatorTok{{-}}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ir\_nls\_stderr)}
\NormalTok{NLS\_U95 \textless{}{-}}\StringTok{ }\NormalTok{(ir\_nls\_par }\OperatorTok{+}\StringTok{ }\KeywordTok{qnorm}\NormalTok{(}\DecValTok{1}\OperatorTok{{-}}\NormalTok{(ALPHA}\OperatorTok{/}\DecValTok{2}\NormalTok{)) }\OperatorTok{*}\StringTok{ }\NormalTok{ir\_nls\_stderr)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{NLS\_U95[}\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{] \textless{}{-}}\StringTok{ }\OtherTok{NaN}
\NormalTok{NLS\_L95[}\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{] \textless{}{-}}\StringTok{ }\OtherTok{NaN}
\KeywordTok{rbind}\NormalTok{(ML\_U95, ML\_L95, NLS\_U95, NLS\_L95)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Linf       vbk      tknot      sig
## ML_U95  1101.7064 0.2376684 -0.9299628 60.64261
## ML_L95   865.9982 0.1415629 -1.5037564 55.97022
## NLS_U95 1102.4265 0.2405846 -0.9139983      NaN
## NLS_L95  852.0484 0.1382837 -1.5216089      NaN
\end{verbatim}

\hypertarget{compare-the-estimated-confidence-intervals-between-methods.-1}{%
\subsubsection{Compare the estimated confidence intervals between
methods.}\label{compare-the-estimated-confidence-intervals-between-methods.-1}}

It's interesting that here all parameters are extremely close in terms
of bounds - even \(L_{\infty}\).

\hypertarget{using-the-likelihood-based-model-parameter-estimates-for-each-population-calculate-the-mean-length-at-each-age-for-age-0-to-age-8-for-each-population.}{%
\subsection{5. Using the likelihood-based model parameter estimates for
each population, calculate the mean length at each age for age 0 to age
8 for each
population.}\label{using-the-likelihood-based-model-parameter-estimates-for-each-population-calculate-the-mean-length-at-each-age-for-age-0-to-age-8-for-each-population.}}

\hypertarget{report-the-mean-length-at-age-for-each-population.}{%
\subsubsection{Report the mean length at age for each
population.}\label{report-the-mean-length-at-age-for-each-population.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{age \textless{}{-}}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{ch\_tl \textless{}{-}}\StringTok{ }\KeywordTok{predict\_length}\NormalTok{(}
\NormalTok{  age, ch\_pred\_params[}\DecValTok{1}\NormalTok{], ch\_pred\_params[}\DecValTok{2}\NormalTok{], ch\_pred\_params[}\DecValTok{3}\NormalTok{]}
\NormalTok{)}
\NormalTok{ir\_tl \textless{}{-}}\StringTok{ }\KeywordTok{predict\_length}\NormalTok{(}
\NormalTok{  age, ir\_pred\_params[}\DecValTok{1}\NormalTok{], ir\_pred\_params[}\DecValTok{2}\NormalTok{], ir\_pred\_params[}\DecValTok{3}\NormalTok{]}
\NormalTok{)}
\KeywordTok{cbind}\NormalTok{(age, ch\_tl, ir\_tl)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       age    ch_tl    ir_tl
##  [1,]   0 203.5166 201.2637
##  [2,]   1 312.2402 335.2111
##  [3,]   2 400.7624 446.0227
##  [4,]   3 472.8369 537.6946
##  [5,]   4 531.5196 613.5326
##  [6,]   5 579.2988 676.2717
##  [7,]   6 618.2005 728.1743
##  [8,]   7 649.8741 771.1122
##  [9,]   8 675.6626 806.6337
\end{verbatim}

\hypertarget{compare-the-length-at-age-between-the-two-populations.}{%
\subsubsection{Compare the length at age between the two
populations.}\label{compare-the-length-at-age-between-the-two-populations.}}

Clearly Indian River is growing faster and larger than the Charlotte
Harbor. It's also pretty unbiologically sound that at age 0 they are
200mm already given they should be more like 6mm.

\hypertarget{set-up-an-aic-table}{%
\subsection{6. Set up an AIC table:}\label{set-up-an-aic-table}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{map\_columns \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(v, cols) \{}
\NormalTok{    c \textless{}{-}}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{8}\NormalTok{)}
\NormalTok{    i \textless{}{-}}\StringTok{ }\DecValTok{0}
    \ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ cols) \{}
\NormalTok{        i \textless{}{-}}\StringTok{ }\NormalTok{i }\OperatorTok{+}\StringTok{ }\DecValTok{1}
        \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{endsWith}\NormalTok{(col, }\StringTok{\textquotesingle{}Linf\textquotesingle{}}\NormalTok{)) \{}
\NormalTok{            j \textless{}{-}}\StringTok{ }\DecValTok{1}
\NormalTok{        \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{endsWith}\NormalTok{(col, }\StringTok{\textquotesingle{}vbk\textquotesingle{}}\NormalTok{)) \{}
\NormalTok{            j \textless{}{-}}\StringTok{ }\DecValTok{3}
\NormalTok{        \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{endsWith}\NormalTok{(col, }\StringTok{\textquotesingle{}tknot\textquotesingle{}}\NormalTok{)) \{}
\NormalTok{            j \textless{}{-}}\StringTok{ }\DecValTok{5}
\NormalTok{        \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{            j \textless{}{-}}\StringTok{ }\DecValTok{7}
\NormalTok{        \}}

        \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{startsWith}\NormalTok{(col, }\StringTok{\textquotesingle{}ch\_\textquotesingle{}}\NormalTok{)) \{}
\NormalTok{            c[j] \textless{}{-}}\StringTok{ }\NormalTok{v[i]}
\NormalTok{        \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\KeywordTok{startsWith}\NormalTok{(col, }\StringTok{\textquotesingle{}ir\_\textquotesingle{}}\NormalTok{)) \{}
\NormalTok{            c[j}\OperatorTok{+}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\NormalTok{v[i]}
\NormalTok{        \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{            c[j] \textless{}{-}}\StringTok{ }\NormalTok{v[i]}
\NormalTok{            c[j}\OperatorTok{+}\DecValTok{1}\NormalTok{] \textless{}{-}}\StringTok{ }\NormalTok{v[i]}
\NormalTok{        \}}
\NormalTok{    \}}
    \KeywordTok{return}\NormalTok{(c)}
\NormalTok{\}}

\KeywordTok{map\_columns}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{), }\KeywordTok{c}\NormalTok{(}\StringTok{\textquotesingle{}ir\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 1 2 2 3 3 4 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{do\_likelihood\_fit \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(v, cols, runs) \{}
\NormalTok{  objective \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(v) \{}
\NormalTok{    c \textless{}{-}}\StringTok{ }\KeywordTok{map\_columns}\NormalTok{(v, cols)}

\NormalTok{    ch\_Linf \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(c[}\DecValTok{1}\NormalTok{])}
\NormalTok{    ch\_vbk \textless{}{-}}\StringTok{ }\NormalTok{c[}\DecValTok{3}\NormalTok{]}
\NormalTok{    ch\_tknot \textless{}{-}}\StringTok{ }\NormalTok{c[}\DecValTok{5}\NormalTok{]}
\NormalTok{    ch\_sig \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(c[}\DecValTok{7}\NormalTok{])}

\NormalTok{    ir\_Linf \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(c[}\DecValTok{2}\NormalTok{])}
\NormalTok{    ir\_vbk \textless{}{-}}\StringTok{ }\NormalTok{c[}\DecValTok{4}\NormalTok{]}
\NormalTok{    ir\_tknot \textless{}{-}}\StringTok{ }\NormalTok{c[}\DecValTok{6}\NormalTok{]}
\NormalTok{    ir\_sig \textless{}{-}}\StringTok{ }\KeywordTok{exp}\NormalTok{(c[}\DecValTok{8}\NormalTok{])}

\NormalTok{    ch\_NLL \textless{}{-}}\StringTok{ }\KeywordTok{get\_likelihood}\NormalTok{(ch\_data}\OperatorTok{$}\NormalTok{yearsold, ch\_data}\OperatorTok{$}\NormalTok{tl, ch\_Linf, ch\_vbk, ch\_tknot, ch\_sig)}
\NormalTok{    ir\_NLL \textless{}{-}}\StringTok{ }\KeywordTok{get\_likelihood}\NormalTok{(ir\_data}\OperatorTok{$}\NormalTok{yearsold, ir\_data}\OperatorTok{$}\NormalTok{tl, ir\_Linf, ir\_vbk, ir\_tknot, ir\_sig)}

\NormalTok{    NLL \textless{}{-}}\StringTok{ }\NormalTok{ch\_NLL }\OperatorTok{+}\StringTok{ }\NormalTok{ir\_NLL}
    \KeywordTok{return}\NormalTok{(NLL)}
\NormalTok{  \}}

  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\NormalTok{runs) \{}
\NormalTok{    fit \textless{}{-}}\StringTok{ }\KeywordTok{optim}\NormalTok{(v, objective, }\DataTypeTok{hessian=}\NormalTok{T)}
\NormalTok{    v \textless{}{-}}\StringTok{ }\NormalTok{fit}\OperatorTok{$}\NormalTok{par}
\NormalTok{  \}}
  \KeywordTok{return}\NormalTok{(fit)}
\NormalTok{\}}

\NormalTok{summarize\_aic \textless{}{-}}\StringTok{ }\ControlFlowTok{function}\NormalTok{(fit, cols) \{}
\NormalTok{  dof \textless{}{-}}\StringTok{ }\KeywordTok{length}\NormalTok{(cols)}
\NormalTok{  nll \textless{}{-}}\StringTok{ }\NormalTok{fit}\OperatorTok{$}\NormalTok{value}
\NormalTok{  aic \textless{}{-}}\StringTok{ }\DecValTok{2}\OperatorTok{*}\NormalTok{nll }\OperatorTok{+}\StringTok{ }\DecValTok{2}\OperatorTok{*}\NormalTok{dof}
\NormalTok{  row \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{paste}\NormalTok{(cols, }\DataTypeTok{collapse=}\StringTok{\textquotesingle{},\textquotesingle{}}\NormalTok{), dof, nll, aic)}
  \KeywordTok{return}\NormalTok{(row)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{determine-the-log-likelihood-the-number-of-parameters-and-the-aic-for}{%
\subsubsection{Determine the log likelihood, the number of parameters,
and the AIC
for:}\label{determine-the-log-likelihood-the-number-of-parameters-and-the-aic-for}}

\hypertarget{a-model-with-different-parameters-l_infty-t_0-k-and-sigma-for-each-population.}{%
\paragraph{\texorpdfstring{A model with different parameters
(\(L_{\infty}, t_0, k,\) and \(\sigma\)) for each
population.}{A model with different parameters (L\_\{\textbackslash infty\}, t\_0, k, and \textbackslash sigma) for each population.}}\label{a-model-with-different-parameters-l_infty-t_0-k-and-sigma-for-each-population.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}\NormalTok{,}
  \FloatTok{6.9}\NormalTok{,  }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.2}\NormalTok{,  }\FloatTok{4.1}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}ch\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_sig\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ir\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_sig\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.6698015  0.2058859 -1.4495751  3.7381019  6.8934140  0.1860532 -1.2361554
## [8]  4.0651624
## 
## $value
## [1] 12236.3
## 
## $counts
## function gradient 
##      215       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]          [,3]          [,4]          [,5]
## [1,] 112181.383961  347993.25653 -1.925144e+04 -6.426805e+00      0.000000
## [2,] 347993.256531 1098196.84390 -6.250397e+04 -1.593776e+01      0.000000
## [3,] -19251.438278  -62503.97185  3.756849e+03  9.573509e-01      0.000000
## [4,]     -6.426805     -15.93776  9.573509e-01  2.203885e+03      0.000000
## [5,]      0.000000       0.00000  0.000000e+00  0.000000e+00  76678.357183
## [6,]      0.000000       0.00000  2.273737e-07 -2.273737e-07 282775.217390
## [7,]      0.000000       0.00000  0.000000e+00  0.000000e+00 -15298.653825
## [8,]      0.000000       0.00000  0.000000e+00  0.000000e+00     -3.567621
##               [,6]          [,7]         [,8]
## [1,]  0.000000e+00  0.000000e+00    0.0000000
## [2,]  0.000000e+00  0.000000e+00    0.0000000
## [3,]  2.273737e-07  0.000000e+00    0.0000000
## [4,] -2.273737e-07  0.000000e+00    0.0000000
## [5,]  2.827752e+05 -1.529865e+04   -3.5676208
## [6,]  1.058861e+06 -5.893007e+04    6.2779386
## [7,] -5.893007e+04  3.489742e+03   -0.1100952
## [8,]  6.277939e+00 -1.100952e-01 2389.0876109
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(all\_free \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ch_Linf,ch_vbk,ch_tknot,ch_sig,ir_Linf,ir_vbk,ir_tknot,ir_sig"
## [2] "8"                                                            
## [3] "12236.300720374"                                              
## [4] "24488.6014407481"
\end{verbatim}

\hypertarget{a-model-with-shared-parameters-for-both-populations.}{%
\paragraph{A model with shared parameters for both
populations.}\label{a-model-with-shared-parameters-for-both-populations.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}sig\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.8171686  0.1797327 -1.4666141  4.0528655
## 
## $value
## [1] 12569.06
## 
## $counts
## function gradient 
##       99       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##             [,1]          [,2]          [,3]        [,4]
## [1,] 137876.9646  520338.81924 -25168.801018   -7.391700
## [2,] 520338.8192 1990716.25051 -98792.191938  -18.505014
## [3,] -25168.8010  -98792.19194   5182.480004    1.192387
## [4,]     -7.3917     -18.50501      1.192387 4595.299049
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(all\_shared \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Linf,vbk,tknot,sig" "4"                  "12569.0570197932"  
## [4] "25146.1140395863"
\end{verbatim}

\hypertarget{which-hypothesis-had-the-most-support-based-on-aic}{%
\subsubsection{Which hypothesis had the most support based on
AIC?}\label{which-hypothesis-had-the-most-support-based-on-aic}}

As in the last lab, all parameters shared has the most support.

\hypertarget{continue-adding-to-your-aic-table.}{%
\subsection{7. Continue adding to your AIC
table.}\label{continue-adding-to-your-aic-table.}}

\hypertarget{determine-the-log-likelihood-function-the-log-likelihood-the-number-of-parameters-and-the-aic-for}{%
\subsubsection{Determine the log likelihood function, the log
likelihood, the number of parameters, and the AIC
for}\label{determine-the-log-likelihood-function-the-log-likelihood-the-number-of-parameters-and-the-aic-for}}

\hypertarget{models-that-share-only-one-of-the-vbgm-parameters-l_infty-t_0-k-and-sigma-for-each-population-hint-this-should-result-in-four-additional-models-for-each-population.}{%
\paragraph{\texorpdfstring{Models that share only one of the VBGM
parameters (\(L_{\infty}, t_0, k,\) and \(\sigma\)) for each population
(hint: this should result in four additional models for each
population).}{Models that share only one of the VBGM parameters (L\_\{\textbackslash infty\}, t\_0, k, and \textbackslash sigma) for each population (hint: this should result in four additional models for each population).}}\label{models-that-share-only-one-of-the-vbgm-parameters-l_infty-t_0-k-and-sigma-for-each-population-hint-this-should-result-in-four-additional-models-for-each-population.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}\NormalTok{,}
  \FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.2}\NormalTok{,  }\FloatTok{4.1}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_sig\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ir\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_sig\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.8068761  0.1532091 -1.8059854  3.7401227  0.2239987 -1.0478161  4.0655605
## 
## $value
## [1] 12239.52
## 
## $counts
## function gradient 
##      192       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##              [,1]          [,2]          [,3]          [,4]          [,5]
## [1,] 188324.30850  5.088257e+05 -1.887554e+04 -5.441198e+01  2.218592e+05
## [2,] 508825.67475  2.337803e+06 -8.853964e+04  8.041794e+00 -9.094947e-07
## [3,] -18875.53594 -8.853964e+04  3.518782e+03  3.565174e-01  0.000000e+00
## [4,]    -54.41198  8.041794e+00  3.565174e-01  2.204096e+03 -9.094947e-07
## [5,] 221859.22437 -9.094947e-07  0.000000e+00 -9.094947e-07  6.574851e+05
## [6,] -15462.87936  0.000000e+00  0.000000e+00  0.000000e+00 -4.738922e+04
## [7,]     54.78169  0.000000e+00  0.000000e+00  0.000000e+00  2.943767e+00
##               [,6]          [,7]
## [1,] -1.546288e+04  5.478169e+01
## [2,]  0.000000e+00  0.000000e+00
## [3,]  0.000000e+00  0.000000e+00
## [4,]  0.000000e+00  0.000000e+00
## [5,] -4.738922e+04  2.943767e+00
## [6,]  3.650500e+03 -2.950856e-03
## [7,] -2.950856e-03  2.390953e+03
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(Linf\_shared \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Linf,ch_vbk,ch_tknot,ch_sig,ir_vbk,ir_tknot,ir_sig"
## [2] "7"                                                 
## [3] "12239.5224904294"                                  
## [4] "24493.0449808588"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}\NormalTok{,}
  \FloatTok{6.9}\NormalTok{,  }\FloatTok{{-}1.2}\NormalTok{,  }\FloatTok{4.1}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}ch\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_sig\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ir\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_sig\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.6866966  0.1977578 -1.5017712  3.7381292  6.8648702 -1.1711513  4.0649778
## 
## $value
## [1] 12236.39
## 
## $counts
## function gradient 
##      180       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]          [,3]         [,4]          [,5]
## [1,]  1.121581e+05  366804.57392 -1.918373e+04    4.9503260 -4.547474e-07
## [2,]  3.668046e+05 2126473.25099 -6.550165e+04   39.7806680  2.615699e+05
## [3,] -1.918373e+04  -65501.65115  3.713248e+03    0.1034027  4.547474e-07
## [4,]  4.950326e+00      39.78067  1.034027e-01 2203.9542305  0.000000e+00
## [5,] -4.547474e-07  261569.89134  4.547474e-07    0.0000000  7.669719e+04
## [6,] -2.273737e-07  -54995.95528  2.273737e-07    0.0000000 -1.538221e+04
## [7,]  0.000000e+00     -10.83637  0.000000e+00    0.0000000  2.695255e+00
##               [,6]        [,7]
## [1,] -2.273737e-07    0.000000
## [2,] -5.499596e+04  -10.836374
## [3,]  2.273737e-07    0.000000
## [4,]  0.000000e+00    0.000000
## [5,] -1.538221e+04    2.695255
## [6,]  3.551922e+03   -1.031214
## [7,] -1.031214e+00 2390.151049
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(vbk\_shared \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ch_Linf,vbk,ch_tknot,ch_sig,ir_Linf,ir_tknot,ir_sig"
## [2] "7"                                                  
## [3] "12236.3934261983"                                   
## [4] "24486.7868523965"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}\NormalTok{,}
  \FloatTok{6.9}\NormalTok{,  }\FloatTok{0.2}\NormalTok{, }\FloatTok{4.1}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}ch\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_sig\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ir\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_sig\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.6411004  0.2216115 -1.3462903  3.7384119  6.9343917  0.1699523  4.0654174
## 
## $value
## [1] 12236.86
## 
## $counts
## function gradient 
##      194       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]        [,3]         [,4]          [,5]
## [1,]  1.121026e+05 315760.971000 -19409.8411   -0.5502118  0.000000e+00
## [2,]  3.157610e+05 907209.514896 -57515.5350    9.6947774  0.000000e+00
## [3,] -1.940984e+04 -57515.534999   7230.1371  -10.1015044 -1.510730e+04
## [4,] -5.502118e-01      9.694777    -10.1015 2203.4393414  0.000000e+00
## [5,]  0.000000e+00      0.000000 -15107.3000    0.0000000  7.663296e+04
## [6,]  0.000000e+00      0.000000 -64885.4245    0.0000000  3.167108e+05
## [7,]  0.000000e+00      0.000000     10.1164    0.0000000  1.951494e-01
##               [,6]         [,7]
## [1,]  0.000000e+00    0.0000000
## [2,]  0.000000e+00    0.0000000
## [3,] -6.488542e+04   10.1163982
## [4,]  0.000000e+00    0.0000000
## [5,]  3.167108e+05    0.1951494
## [6,]  1.325922e+06    5.3842418
## [7,]  5.384242e+00 2389.1819192
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(tknot\_shared \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ch_Linf,ch_vbk,tknot,ch_sig,ir_Linf,ir_vbk,ir_sig"
## [2] "7"                                                
## [3] "12236.8592624778"                                 
## [4] "24487.7185249557"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{v \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \FloatTok{6.7}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.5}\NormalTok{,  }\FloatTok{3.7}\NormalTok{,}
  \FloatTok{6.9}\NormalTok{,  }\FloatTok{0.2}\NormalTok{, }\FloatTok{{-}1.2}
\NormalTok{) }
\NormalTok{cols \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}ch\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ch\_tknot\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}sig\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ir\_Linf\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_vbk\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}ir\_tknot\textquotesingle{}}
\NormalTok{)}
\NormalTok{(fit \textless{}{-}}\StringTok{ }\KeywordTok{do\_likelihood\_fit}\NormalTok{(v, cols, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $par
## [1]  6.6676369  0.2069044 -1.4436927  3.9341872  6.8839452  0.1897212 -1.2165016
## 
## $value
## [1] 12295.98
## 
## $counts
## function gradient 
##      182       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
## 
## $hessian
##               [,1]          [,2]          [,3]          [,4]          [,5]
## [1,]  7.578281e+04  2.335499e+05 -1.300820e+04   -0.55997748  0.000000e+00
## [2,]  2.335499e+05  7.323867e+05 -4.197229e+04   -2.61466539 -4.547474e-07
## [3,] -1.300820e+04 -4.197229e+04  2.540665e+03    0.22086579  4.547474e-07
## [4,] -5.599775e-01 -2.614665e+00  2.208658e-01 4593.40523503  2.110082e+00
## [5,]  0.000000e+00 -4.547474e-07  4.547474e-07    2.11008182  9.963053e+04
## [6,] -2.273737e-07  4.547474e-07 -2.273737e-07    9.33348656  3.583302e+05
## [7,] -4.547474e-07  0.000000e+00  4.547474e-07   -0.07147719 -1.990348e+04
##               [,6]          [,7]
## [1,] -2.273737e-07 -4.547474e-07
## [2,]  4.547474e-07  0.000000e+00
## [3,] -2.273737e-07  4.547474e-07
## [4,]  9.333487e+00 -7.147719e-02
## [5,]  3.583302e+05 -1.990348e+04
## [6,]  1.309389e+06 -7.485600e+04
## [7,] -7.485600e+04  4.555389e+03
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(sig\_shared \textless{}{-}}\StringTok{ }\KeywordTok{summarize\_aic}\NormalTok{(fit, cols))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ch_Linf,ch_vbk,ch_tknot,sig,ir_Linf,ir_vbk,ir_tknot"
## [2] "7"                                                  
## [3] "12295.979579067"                                    
## [4] "24605.959158134"
\end{verbatim}

\hypertarget{calculate-the-aic-for-all-the-models-you-trialed-report-your-aic-table-to-answer-questions-6-7-and-8.}{%
\subsection{8. Calculate the âˆ†AIC for all the models you trialed (report
your AIC table to answer questions 6, 7, and
8).}\label{calculate-the-aic-for-all-the-models-you-trialed-report-your-aic-table-to-answer-questions-6-7-and-8.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{aic\_table \textless{}{-}}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\KeywordTok{rbind}\NormalTok{(}
\NormalTok{    all\_free,}
\NormalTok{    all\_shared,}
\NormalTok{    Linf\_shared,}
\NormalTok{    vbk\_shared,}
\NormalTok{    tknot\_shared,}
\NormalTok{    sig\_shared}
\NormalTok{))}
\KeywordTok{colnames}\NormalTok{(aic\_table) \textless{}{-}}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{\textquotesingle{}cols\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}dof\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}nll\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}aic\textquotesingle{}}\NormalTok{)}
\NormalTok{(aic\_table \textless{}{-}}\StringTok{ }\NormalTok{aic\_table[}\KeywordTok{order}\NormalTok{(aic\_table}\OperatorTok{$}\NormalTok{aic),])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                                                                       cols dof
## vbk_shared             ch_Linf,vbk,ch_tknot,ch_sig,ir_Linf,ir_tknot,ir_sig   7
## tknot_shared             ch_Linf,ch_vbk,tknot,ch_sig,ir_Linf,ir_vbk,ir_sig   7
## all_free     ch_Linf,ch_vbk,ch_tknot,ch_sig,ir_Linf,ir_vbk,ir_tknot,ir_sig   8
## Linf_shared             Linf,ch_vbk,ch_tknot,ch_sig,ir_vbk,ir_tknot,ir_sig   7
## sig_shared             ch_Linf,ch_vbk,ch_tknot,sig,ir_Linf,ir_vbk,ir_tknot   7
## all_shared                                              Linf,vbk,tknot,sig   4
##                           nll              aic
## vbk_shared   12236.3934261983 24486.7868523965
## tknot_shared 12236.8592624778 24487.7185249557
## all_free      12236.300720374 24488.6014407481
## Linf_shared  12239.5224904294 24493.0449808588
## sig_shared    12295.979579067  24605.959158134
## all_shared   12569.0570197932 25146.1140395863
\end{verbatim}

\hypertarget{which-hypothesis-had-the-most-support-based-on-aic-1}{%
\subsubsection{Which hypothesis had the most support based on
AIC?}\label{which-hypothesis-had-the-most-support-based-on-aic-1}}

Sharing \(k\) had the best support.

\hypertarget{what-are-the-top-models-based-on-the-aic}{%
\subsubsection{What are the top models based on the
AIC?}\label{what-are-the-top-models-based-on-the-aic}}

Sharing \(k\), sharing \(t_0\), and all free were the best.

\hypertarget{do-these-top-models-make-sense-given-the-biology-of-spotted-seatrout}{%
\subsubsection{Do these top models make sense given the biology of
Spotted
Seatrout?}\label{do-these-top-models-make-sense-given-the-biology-of-spotted-seatrout}}

Sharing \(t_0\) makes sense but the \(t_0\) here is certainly
unbiological. Growth rates would definitely change from place to place,
but I think we're still able to fit reasonably well because \(t_0\) and
\(L_{/infty}\) are still free in the shared \(k\) case and we know these
are all extremely correlated with one another. In general across these
models the wild \(t_0\) makes these rather unbiological.

\hypertarget{adjust-the-slot-limits-for-the-following-scenarios-and-answer-the-following-questions}{%
\subsection{9. Adjust the slot limits for the following scenarios and
answer the following
questions:}\label{adjust-the-slot-limits-for-the-following-scenarios-and-answer-the-following-questions}}

\begin{longtable}[]{@{}llllll@{}}
\toprule
\begin{minipage}[b]{0.14\columnwidth}\raggedright
MinLL\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright
MaxLL\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright
Bias\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright
Over\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright
Under\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright
Parameters\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.14\columnwidth}\raggedright
300 (0.05)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(\infty\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(<2\) years old undersampled\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(<4\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
N/A\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(L_{\infty}=914, k=0.178, t_0=-1.09, \sigma=110.0\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.14\columnwidth}\raggedright
0\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
700 (0.05)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(>3\) years old undersampled\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(0<age<3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(>3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(L_{\infty}=667, k=0.335, t_0=-0.39, \sigma=66.2\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.14\columnwidth}\raggedright
380 (0)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
480 (0)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
Almost no sampling for age \(>6\) or \(<2\), extremely poor sampling
across the board.\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(<3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(>3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(L_{\infty}=446, k=0.939, t_0=-1.15, \sigma=26.4\)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.14\columnwidth}\raggedright
380 (0)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
530 (0.03)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
No sampling for age \(<2\) biased toward middling or smaller fish
throughout.\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(<3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(>3\)\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright
\(L_{\infty}=532, k=0.222, t_0=-5.56, \sigma=40.2\)\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{across-scenarios-which-had-the-biggest-impact-on-l_-on-k-on-t_0}{%
\subsubsection{Across scenarios, which had the biggest impact on L\_âˆž?
on k? on
t\_0?}\label{across-scenarios-which-had-the-biggest-impact-on-l_-on-k-on-t_0}}

\begin{itemize}
\tightlist
\item
  \(L_{\infty}\) - Definitely case 3, the total lack of sampling of
  large fish threw things off entirely.
\item
  \(k\) - Likewise case 3.
\item
  \(t_0\) - case 4, the complete lack of samples on the low end with
  samples on the high end gave us a weird almost straight relationship
  between age and growth.
\end{itemize}

\end{document}
